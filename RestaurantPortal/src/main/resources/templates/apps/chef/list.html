<!DOCTYPE html>
<html lang="en">
<!--begin::Head-->

<div th:replace="~{fragments/partial :: page_head('Ingredient', 'none')}"></div>

<!-- Link to Toastify CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Link to Toastify JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

	
<!-- Add custom styles here -->
  <style>
  /* Add custom styles here */
  
  .card-header-custom {
    display: flex;
    justify-content: center; /* Center the title container */
    align-items: center;
    padding: 10px; /* Adjust padding to preference */
    font-family: 'Roboto', sans-serif;
    font-size: 14px;
    font-weight: 150;
}

/* Style the filter container */
.status-filter-container {
    display: flex;
    justify-content: center; /* Center filters */
    align-items: center;
    flex-wrap: wrap; /* Allow wrapping on smaller screens */
    gap: 50px; /* Space between filters */
    width: 100%;
    margin-top: 10px; /* Add space above the filter container */
}

/* Style the labels and checkboxes inside the filter container */
.status-filter-container label {
    display: flex;
    align-items: center;
    font-size: 16px; /* Match font size with the rest */
    cursor: pointer; /* Indicate clickable items */
}

/* Style the checkboxes */
.status-filter-container input[type="checkbox"] {
    margin-right: 5px; /* Adjust space between checkbox and label text */
}

  /* This targets the direct child div of card-header with class card-title */
  .card-header > .card-title {
    padding-top: 0; /* Remove padding from the top of the card title */
    margin-top: 0; /* Remove margin from the top of the card title */
  }
  
</style>

</head>
<!--end::Head-->
<!--end::Head-->
<!--begin::Body-->


<body data-kt-name="metronic" id="kt_app_body"
	data-kt-app-layout="dark-sidebar" data-kt-app-header-fixed="true"
	data-kt-app-sidebar-enabled="true" data-kt-app-sidebar-fixed="true"
	data-kt-app-sidebar-hoverable="true"
	data-kt-app-sidebar-push-header="true"
	data-kt-app-sidebar-push-toolbar="true"
	data-kt-app-sidebar-push-footer="true"
	data-kt-app-toolbar-enabled="true" class="app-default">
	<!--begin::Theme mode setup on page load-->
	<script>
		if (document.documentElement) {
			const defaultThemeMode = "system";
			const name = document.body.getAttribute("data-kt-name");
			let themeMode = localStorage.getItem("kt_"
					+ (name !== null ? name + "_" : "") + "theme_mode_value");
			if (themeMode === null) {
				if (defaultThemeMode === "system") {
					themeMode = window
							.matchMedia("(prefers-color-scheme: dark)").matches ? "dark"
							: "light";
				} else {
					themeMode = defaultThemeMode;
				}
			}
			document.documentElement.setAttribute("data-theme", themeMode);
		}
	</script>
	<!--end::Theme mode setup on page load-->
	<!--begin::App-->
	<div class="d-flex flex-column flex-root app-root" id="kt_app_root">
		<!--begin::Page-->
		<div class="app-page flex-column flex-column-fluid" id="kt_app_page">
			<div th:replace="fragments/header :: header">&nbsp;</div>
			<!--begin::Wrapper-->
			<div class="app-wrapper flex-column flex-row-fluid"
				id="kt_app_wrapper">
				<div th:replace="fragments/sidebar :: sidebar"></div>
				<!--begin::Main-->
				<div class="app-main flex-column flex-row-fluid" id="kt_app_main">
					<!--begin::Content wrapper-->
					<div class="d-flex flex-column flex-column-fluid">
						<!--begin::Toolbar-->
						<div id="kt_app_toolbar" class="app-toolbar py-3 py-lg-6">
							<!--begin::Toolbar container-->
							<div id="kt_app_toolbar_container"
								class="app-container container-xxl d-flex flex-stack">
								<!--begin::Page title-->
								<div
									class="page-title d-flex flex-column justify-content-center flex-wrap me-3">
									<!--begin::Title-->
									<h1
										class="page-heading d-flex text-dark fw-bold fs-3 flex-column justify-content-center my-0">
										Disher List</h1>
									<!--end::Title-->
									<!--begin::Breadcrumb-->
									<ul
										class="breadcrumb breadcrumb-separatorless fw-semibold fs-7 my-0 pt-1">
										<!--begin::Item-->
										<li class="breadcrumb-item text-muted"><a
											href="../../demo1/dist/index.html"
											class="text-muted text-hover-primary">Home</a></li>
										<!--end::Item-->
										<!--begin::Item-->
										<li class="breadcrumb-item"><span
											class="bullet bg-gray-400 w-5px h-2px"></span></li>
										<!--end::Item-->
										<!--begin::Item-->
										<li class="breadcrumb-item text-muted">Chef</li>
										<!--end::Item-->
									</ul>
									<!--end::Breadcrumb-->
								</div>
								<!--end::Page title-->
							</div>
							<!--end::Toolbar container-->
						</div>
						<!--end::Toolbar-->
						<!--begin::Content-->
						<div id="kt_app_content" class="app-content flex-column-fluid">
							<!--begin::Content container-->
							<div id="kt_app_content_container"
								class="app-container container-xxl">
								<!--begin::Card-->
								<div class="card">
									<!--begin::Card header-->
									<div class="card-header d-flex justify-content-around ">
									<div class="card-title ">
														<!-- Lọc theo trạng thái -->
														<div class=" status-filter-container">
															<label><input type="checkbox"
																class="status-filter" value="PENDING" checked>
																Pending</label> <label><input type="checkbox"
																class="status-filter" value="PREPARING" checked>
																Preparing</label> <label><input type="checkbox"
																class="status-filter" value="READY" checked>
																Ready</label> <label><input type="checkbox"
																class="status-filter" value="SERVING" checked>
																Serving</label> <label><input type="checkbox"
																class="status-filter" value="COMPLETED" checked>
																Completed</label>
														</div>
													</div>
									
										<!--end::Card header-->
										<!--end::Search-->
									</div>
									<!--begin::Card title-->
									<!--begin::Card toolbar-->
									<div class="card-toolbar">
										<!--begin::Toolbar-->
										<div class="d-flex justify-content-end"
											data-kt-customer-table-toolbar="base"></div>
										<!--end::Toolbar-->
										<!--begin::Group actions-->
										<div
											class="d-flex justify-content-end align-items-center d-none"
											data-kt-customer-table-toolbar="selected">
											<div class="fw-bold me-5">
												<span class="me-2"
													data-kt-customer-table-select="selected_count"></span>Selected
											</div>
											<button type="button" class="btn btn-danger"
												data-kt-customer-table-select="delete_selected">
												Delete Selected</button>
										</div>
										<!--end::Group actions-->
									</div>
									<!--end::Card toolbar-->
								</div>
								<!--end::Card header-->
								<!--begin::Card body-->
								<div class="card-body pt-0">
									<!--begin::Table-->
									<table class="table align-middle table-row-dashed fs-6 gy-5"
										id="kt_customers_table_skip">
										<!--begin::Table head-->
										<thead>
											<tr
												class="text-start text-gray-400 fw-bold fs-7 text-uppercase gs-0">
												<th>Dish Name</th>
												<th>Photo</th>
												<th>Table Code</th>
												<th>Time</th>
												<th>Status</th>
												<th>Action</th>
												<!-- Đảm bảo thêm cột Action để phản ánh chính xác nội dung dưới đây -->
											</tr>
										</thead>
										<!--end::Table head-->

										<!--begin::Table body-->
										<tbody class="fw-semibold text-gray-600">
											<tr th:each="cartLine : ${cartLines}">
												<td th:text="${cartLine.ingredient.ingredientName}"></td>
												<td><img
													th:src="@{'http://localhost:8082/files/' + ${cartLine.ingredient.photo}}"
													class="img-fluid img-thumbnail"
													style="max-width: 100px; max-height: 100px;"
													alt="Dish Photo"></td>
												<td th:text="${cartLine.tableName}"></td>
												<td
													th:text="${#temporals.format(cartLine.orderTime, 'hh:mm a')}"></td>
												<td th:text="${cartLine.status}"></td>
												<td>
													<!-- Dropdown for updating status --> <select
													th:attr="onchange=|updateStatus(this, ${cartLine.id})|"
													class="form-select form-select-sm">
														<option th:selected="${cartLine.status == 'PENDING'}"
															value="PENDING">Pending</option>
														<option th:selected="${cartLine.status == 'PREPARING'}"
															value="PREPARING">Preparing</option>
														<option th:selected="${cartLine.status == 'READY'}"
															value="READY">Ready</option>
														<option th:selected="${cartLine.status == 'SERVING'}"
															value="SERVING">Serving</option>
														<option th:selected="${cartLine.status == 'COMPLETED'}"
															value="COMPLETED">Completed</option>
												</select>
												</td>
												<td>
													<!-- Dropdown cho việc cập nhật trạng thái đã có --> <!-- Thêm nút xóa tại đây -->
													<!--  <button th:onclick="'deleteCartLine(' + ${cartLine.id} + ');'" class="btn btn-danger btn-sm">Delete</button>-->


												</td>
											</tr>
										</tbody>
										<!--end::Table body-->
									</table>

									<!--end::Table-->
									<!--begin::Paginate-->
									<div th:if="${totalPages > 1}">
										<ul class="pagination">
											<li
												th:class="${currentPage > 1 ? 'page-item previous' : 'page-item previous disabled'}">
												<a
												th:href="@{${moduleURL} + '/page/' + ${currentPage - 1} + ${queryParams}}"
												class="page-link"><i class="previous"></i></a>
											</li>
											<li th:each="i : ${#numbers.sequence(1, totalPages)}"
												th:class="${currentPage != i ? 'page-item' : 'page-item active'}">
												<a
												th:href="@{${moduleURL} + '/page/' + ${i} + ${queryParams}}"
												class="page-link" th:text="${i}"></a>
											</li>
											<li
												th:class="${currentPage < totalPages ? 'page-item next' : 'page-item next disabled' }">
												<a
												th:href="@{${moduleURL} + '/page/' + ${currentPage + 1} + ${queryParams}}"
												class="page-link"><i class="next"></i></a>
											</li>
										</ul>
									</div>
									<!--end::Paginate-->
								</div>
								<!--end::Card body-->

								<!--end::Card-->
								<!--begin::Modals-->
								<!--begin::Modal - User - Add-->

								<!--end::Modal - Customers - Add-->
								<!--begin::Modal - Export Customers-->
								<div class="modal fade" id="kt_customers_export_modal"
									tabindex="-1" aria-hidden="true">
									<!--begin::Modal dialog-->
									<div class="modal-dialog modal-dialog-centered mw-650px">
										<!--begin::Modal content-->
										<div class="modal-content">
											<!--begin::Modal header-->
											<div class="modal-header">
												<!--begin::Modal title-->
												<h2 class="fw-bold">Export Customers</h2>
												<!--end::Modal title-->
												<!--begin::Close-->
												<div id="kt_customers_export_close"
													class="btn btn-icon btn-sm btn-active-icon-primary">
													<!--begin::Svg Icon | path: icons/duotune/arrows/arr061.svg-->
													<span class="svg-icon svg-icon-1"> <svg width="24"
															height="24" viewBox="0 0 24 24" fill="none"
															xmlns="http://www.w3.org/2000/svg">
															<rect opacity="0.5" x="6" y="17.3137" width="16"
																height="2" rx="1" transform="rotate(-45 6 17.3137)"
																fill="currentColor" />
															<rect x="7.41422" y="6" width="16" height="2" rx="1"
																transform="rotate(45 7.41422 6)" fill="currentColor" />
														</svg>
													</span>
													<!--end::Svg Icon-->
												</div>
												<!--end::Close-->
											</div>
											<!--end::Modal header-->
											<!--begin::Modal body-->
											<div class="modal-body scroll-y mx-5 mx-xl-15 my-7">
												<!--begin::Form-->
												<form id="kt_customers_export_form" class="form"
													th:action="@{/users/export}" method="post">
													<!--begin::Input group-->
													
														<!--end::Input-->
													</div>
													<!--end::Input group-->
													<!--begin::Input group-->
													<div class="fv-row mb-10">
														<!--begin::Label-->
														<label class="fs-5 fw-semibold form-label mb-5">Select
															Date Range:</label>
														<!--end::Label-->
														<!--begin::Input-->
														<input class="form-control form-control-solid"
															placeholder="Pick a date" name="date" />
														<!--end::Input-->
													</div>
													<!--end::Input group-->
													<!--begin::Actions-->
													<div class="text-center">
														<button type="reset" id="kt_customers_export_cancel"
															class="btn btn-light me-3">Discard</button>
														<button type="submit" id="kt_customers_export_submit"
															class="btn btn-primary">
															<span class="indicator-label">Submit</span> <span
																class="indicator-progress">Please wait... <span
																class="spinner-border spinner-border-sm align-middle ms-2"></span></span>
														</button>
													</div>
													<!--end::Actions-->
												</form>
												<!--end::Form-->
											</div>
											<!--end::Modal body-->
										</div>
										<!--end::Modal content-->
									</div>
									<!--end::Modal dialog-->
								</div>
								<!--end::Modal - Export Customers-->
								<!--end::Modals-->
							</div>
							<!--end::Content container-->
						</div>
						<!--end::Content-->
					</div>
					<!--end::Content wrapper-->
					<!--begin::Footer-->
					<div th:replace="fragments/footer :: footer">&nbsp;</div>
					<!--end::Footer-->
				</div>
				<!--end:::Main-->
			</div>
			<!--end::Wrapper-->
		</div>
		<!--end::Page-->
	</div>
	<!--end::App-->
	<!--begin::Scrolltop-->
	<div id="kt_scrolltop" class="scrolltop" data-kt-scrolltop="true">
		<!--begin::Svg Icon | path: icons/duotune/arrows/arr066.svg-->
		<span class="svg-icon"> <svg width="24" height="24"
				viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
				<rect opacity="0.5" x="13" y="6" width="13" height="2" rx="1"
					transform="rotate(90 13 6)" fill="currentColor" />
				<path
					d="M12.5657 8.56569L16.75 12.75C17.1642 13.1642 17.8358 13.1642 18.25 12.75C18.6642 12.3358 18.6642 11.6642 18.25 11.25L12.7071 5.70711C12.3166 5.31658 11.6834 5.31658 11.2929 5.70711L5.75 11.25C5.33579 11.6642 5.33579 12.3358 5.75 12.75C6.16421 13.1642 6.83579 13.1642 7.25 12.75L11.4343 8.56569C11.7467 8.25327 12.2533 8.25327 12.5657 8.56569Z"
					fill="currentColor" />
			</svg>
		</span>
		<!--end::Svg Icon-->
	</div>
<script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

	<script>
	function updateStatus(selectElement, cartLineId) {
	    var status = selectElement.value;
	    var statusCell = $(selectElement).closest('tr').find('td').eq(4); // Assuming status is the 5th column

	    $.ajax({
	        url: '/chef/updateStatus',
	        type: 'POST',
	        data: {
	            cartLineId: cartLineId,
	            status: status
	        },
	        success: function(response) {
	            // Update the status cell directly without reloading the page
	            statusCell.text(status);

	            Toastify({
	                text: "Dish status updated successfully!",
	                duration: 4000,
	                close: true,
	                gravity: "top",
	                position: "center",
	                style: {
	                    background: "#28a745",
	                    zIndex: 9999
	                },
	                className: "info",
	            }).showToast();
	        },
	        error: function(xhr, status, error) {
	            Toastify({
	                text: "An error occurred: " + xhr.responseText,
	                duration: 4000,
	                close: true,
	                gravity: "top",
	                position: "right",
	                style: {
	                    background: "#dc3545", // Changed for Bootstrap standard red
	                },
	                className: "error",
	            }).showToast();
	        }
	    });
	}


	</script>
	<script>
		$(document).ready(
				function() {
					$('.status-filter').change(
							function() {
								var selectedStatuses = $(
										'.status-filter:checked').map(
										function() {
											return this.value;
										}).get();

								$('tbody tr').each(
										function() {
											var rowStatus = $(this).find('td')
													.eq(4).text(); // Giả sử cột trạng thái là cột thứ 5
											if (selectedStatuses
													.includes(rowStatus)) {
												$(this).show();
											} else {
												$(this).hide();
											}
										});
							});
				});
	</script>

	<!--end::Scrolltop-->
	<!--begin::Javascript-->




	<!--end::Javascript-->
</body>
<!--end::Body-->

</html>